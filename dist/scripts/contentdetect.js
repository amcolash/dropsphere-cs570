function getMetaContent(a){var b=document.getElementsByTagName("meta");for(i=0;i<b.length;i++)if(b[i].getAttribute("name")==a)return b[i].getAttribute("content");return""}function getContentByMetaTagName(a){for(var b=document.getElementsByTagName("meta"),c=0;c<b.length;c++)if(a==b[c].name||a==b[c].getAttribute("property"))return b[c].content;return!1}function getImage(a){var b="",c=/[^.]+$/.exec(a);if(("jpg"==c||"jpeg"==c||"gif"==c||"png"==c)&&(image=a,title=""),b=getContentByMetaTagName("og:image"))return b;for(var d=document.images,e=0;e<d.length;e++)if(img=d[e],img.height>40&&img.width>40&&img.height<350&&img.width<350)return b=img.src;return""}chrome.runtime.onMessage.addListener(function(a,b,c){if(console.log(b.tab?"from a content script:"+b.tab.url:"from the extension"),"drop"==a)var d=document.URL;c({link:d,title:document.title,description:getMetaContent("description"),image:getImage(d)})});